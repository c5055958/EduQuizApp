{% extends "base.html" %}
{% block title %}My Profile{% endblock %}

{% block content %}
<style>
body {
    background: linear-gradient(-45deg, #4e73df, #1cc88a, #6f42c1, #36b9cc);
    background-size: 400% 400%;
    animation: gradientMove 12s ease infinite;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 0;
}

@keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

.profile-wrapper {
    max-width: 900px;
    margin: 80px auto;
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(20px);
    padding: 50px 40px;
    border-radius: 25px;
    box-shadow: 0 35px 80px rgba(0,0,0,0.4);
    color: #fff;
    text-align: center;
    animation: fadeUp 1s ease;
}

@keyframes fadeUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
}

.profile-avatar {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    margin: 0 auto 20px;
    background: #6f42c1;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 60px;
    font-weight: 700;
    color: #fff;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    overflow: hidden;
}

.profile-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.btn-edit, .btn-back {
    border-radius: 50px;
    padding: 12px 30px;
    font-weight: 700;
    color: #fff;
    border: none;
    transition: all 0.3s ease;
    margin-top: 20px;
    margin-right: 10px;
    cursor: pointer;
}

.btn-edit { background: linear-gradient(135deg, #36b9cc, #1cc88a); }
.btn-edit:hover { transform: scale(1.05); box-shadow: 0 10px 25px rgba(0,0,0,0.4); }

.btn-back { background: linear-gradient(135deg, #4e73df, #6f42c1); }
.btn-back:hover { transform: scale(1.05); box-shadow: 0 10px 25px rgba(0,0,0,0.4); }

.chart-card {
    background: #ffffff;
    border-radius: 18px;
    padding: 25px;
    margin-top: 35px;
    color: #000;
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
}

h2 { font-weight: 900; letter-spacing: 1px; margin-bottom: 10px; font-size: 2rem; }
h3 { font-weight: 700; margin-bottom: 15px; }
p { font-size: 1.1rem; }
</style>

<div class="profile-wrapper">
    <div class="profile-avatar">
        {% if student.profile_image %}
            <img src="{{ url_for('static', filename='images/profiles/' + student.profile_image) }}" alt="Profile Image">
        {% else %}
            {{ student.name[0] }}
        {% endif %}
    </div>

    <h2>{{ student.name }}</h2>
    <p><strong>Email:</strong> {{ student.email }}</p>

    <div>
        <a href="{{ url_for('student_dashboard') }}" class="btn-back">Back</a>
        <a href="{{ url_for('edit_profile') }}" class="btn-edit">Edit Profile</a>
    </div>

    <div class="chart-card">
        <h3>Module-wise Performance (%)</h3>
        <canvas id="performanceChart" width="600" height="300"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const modules = {{ module_labels|tojson }};
const scores = {{ module_scores|tojson }};

new Chart(document.getElementById('performanceChart'), {
    type: 'bar',
    data: {
        labels: modules,
        datasets: [{
            label: 'Score (%)',
            data: scores,
            backgroundColor: 'rgba(54, 185, 204, 0.7)',
            borderColor: 'rgba(36, 139, 203, 1)',
            borderWidth: 1,
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        scales: { y: { beginAtZero: true, max: 100 } },
        plugins: { legend: { display: false } }
    }
});
</script>
{% endblock %}